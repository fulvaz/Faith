这篇文章是对一次失败的外包项目的反思。

背景
---
半年前非常非常缺钱花，因此接了个来自学院老师的外包项目，负责沟通的甲方是一位想转行的学校老师，另外还有投资人，偶尔露脸。而我们这边的主要负责人是我们的老师。和另一位同学商量了一下，直接实践前后端分离，后端以类似RESTful的风格设计api，我负责前端，工作内容是写与公众号绑定的Web App。然而第一次接外包，踩了很多坑，下面分章节说明。

需求不确定
---
学校项目往往没有文档。一般来说，这些项目在外面都是没人肯接，因为这些项目往往没有明确的需求，就算有也会常常变，稍微有点软件工程常识都知道这是大忌。当然，作为学生练手，也没啥关系，就是做得很累（就是9/12/7这样工作）。具体到这个项目中，文档是一个已经上线某app作为参考，甲方与负责人的口头说明，UI设计是自由发挥，技术选型也是自由发挥。

首先是沟通问题。其实需求变动不多，直接抄某app就可以，比较麻烦的是与app不同的内容，这种需求问题其实需要反复与甲方沟通、确认的，然而我这里采取的方法是快速出原型，做完一部分就给甲方看，然后沟通。这里最大的错误是我高估了自己的能力，对一个新手来说，写出健壮、高复用的代码实在太难，结果是，甲方要改的时候，我感觉很为难，修改常常意味着重写。其实在与甲方见面的时候应该认真把这部分给描述清楚，而不是三言两语。有一次功能都做完了，然后甲方提出了异议，表示与说好的不一样，后来发现是负责人与甲方意见不一，我们做的是负责人的要求。这种问题在会议上本可以沟通明白的。

UI设计中消耗了大量时间。让程序员自由发挥设计UI，叫程序员边写代码边做好PM实在是耍流氓。UI实在是一种见仁见智的东西，IOS7刚出来的时候也有人大骂库克毁了苹果，扁平化丑。所以是我的 git 分支里面有：indexV6、circleV3......事实上这些问题都应该避免的。厚着脸皮叫甲方搞定设计的问题，或者是自己找好人，让甲方付钱，一般这种情况，我推荐猪八戒随便找一个。不解决这个接下来会非常辛苦，比如说，甲方完全不懂移动app的设计规则，死活让你按照上个世纪的网页设计方法---把内容尽可能得塞进一个屏幕中。嗯，我觉得丑，甲方也这么觉得，然后让我改......我......我下次让甲方把UI找人弄好了再写前端。

技术选型
---
作为一个外包项目其实我是有私心的，希望将新技术用于实践中，然而这是非常鲁莽的，特别是没有时间进行详细的调查研究。

（这里不想引战，我只是在陈述事实，要是想反驳请就事论事，我很烦各路信徒拿框架说事，浪费时间。还有拿语言说事也是浪费时间）

使用vue是一个错误。在2016年12月时，vue2 刚出不久，整个生态还不完善，那时候很多UI库还只能用于1.x的版本中，这对开发非常不利。

首先是UI库，我的标准是文档要完善，至少能快速上手，作者还在活跃地维护，满足这些标准的只有mint-ui和element-ui，但是这两个ui库还是不够好，幸好有源码，自己研究了下代码，再改了改总算满足甲方需求，但是拖了挺长时间。其次 vue 的生态问题，比如头像裁剪插件，可用的库只有 PC 版，需要使用类似的功能需要自己想办法将类似的插件整合进 vue 中，也花了不少力气。（事实上外包项目应该怎么简单怎么来，最好抄起jq就是干。甲方在项目后期苦恼地和我说找不到会 vue 的人。）然后就是因为不熟悉 vue 而踩到的许多坑，这无法避免。

当然在以后项目的技术选型我会保持慎重，不是新技术差，至少使用前要：1.对自己项目的需求有个详细的规划，需要什么功能，研究该框架的生态，什么插件需要自己写，什么功能有现成库，估摸新框架对项目的影响。2.选用前至少在其他小型项目使用过，对其中的坑有所了解，不要被新框架影响项目进度。比如那时候 vue 严格限制子组件不能直接将信息传递给父组件，设法绕过限制反而使代码更难以维护，后来改需求花了不少时间（现在已经重新加上双向绑定功能，不需要eventhub了）。

技术上的问题
---

### mock server搭建
项目中使用的是`json-server`，这个一个非常优秀的mock服务器，只需要写json就可以生成所需要的mock服务，但是json的问题是，不够灵活。







首先
json server
---

关于vue
---

v-model

vue data 不响应

用js生成dom, 依赖data, 在updated中更新dom, 初始化时在mounted

js生成的dom是不会受到scoped css的约束的

computed只有依赖响应式的变量才会有效

发包含id的数据考虑是否要先parseInt

v-show与v-if的区别, v-if是完全不渲染, v-show只是display:none

'Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the prop's value. Prop being mutated: "ifLiked" ' 这个错误必须认真处理, 不能只是在子组件新建一个data属性绕过这个错误, 子组件的数据必须同步地与父组件数据保持同步, 否则页面更新会父组件的旧数据覆盖掉子组件的新数据





关于vuex
----

在vuex里面进行远程请求还是?在业务中进行?  答: 在业务中进行, vuex只是负责修改状态而已,??


交互方面
---
发送数据到服务器要有成功提示, 错误要处理和提示, 并且提示用户该做什么

从服务器获取数据也和上面做一样的处理

加载页面的错误处理, 必须处理, 并且直接刷新页面


关于api设计
---

客户端知道尽量少的信息就可以使用api --- 不用发多余的东西给服务端
相比post,get等, 其实在路径加动词会更直观. POST /posts, POST /posts/add ??
数据应该有默认值, 空数值用'' (空字符串), 如果后端默认值用null, 马上去打死他, 前端要加很多很多过滤


css
---
开发前要订好全局样式, 即标题文字大小, 描述文字大小, 颜色, 全局背景颜色等.

不用在整个container内设定padding, 应该分别设定子组件padding

移动端慎重使用overflow-y:scroll, 会有性能问题----卡顿

文本的容器高度单位用em或者rem

使用
```
overflow: auto; 
-webkit-overflow-scrolling:touch;
```
也许能有所改善, 但是对我无效. 所以我还是将需要滚动的div放到了'最顶层'


其他tips:
---

this.$route和this.$router不一样

todos
--
webpack

render function

canvas

touch event

PS
---
其实感觉甲方也挺惨，遇到我这种坑货，中间出了一堆坑全要耐着性子等我处理完。而且甲方人也很好，提前给尾款，过年还发红包，简直良心。但愿以后也能遇到良心老板。
